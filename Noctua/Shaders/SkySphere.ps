cbuffer PerObject : register(b0)
{
    float3 SkyColor     : packoffset(c0);
    // ‹“_‚©‚çŒ©‚½‘¾—z‚Ì•ûŒü
    float3 SunDirection : packoffset(c1);
    float3 SunColor     : packoffset(c2);
    // ‘¾—z‚ÌêŠ‚ğ”»’è‚·‚é‚½‚ß‚Ìè‡’l (0.999 ˆÈã‚ª‘Ã“–)
    float SunThreshold  : packoffset(c3.x);
    // 0: ‘¾—z‚ğ•`‰æ‚µ‚È‚¢
    // 1: ‘¾—z‚ğ•`‰æ‚·‚é
    float SunVisible    : packoffset(c3.y);
};

struct Input
{
    float4 Position : SV_Position;
    float3 Normal   : NORMAL0;
};

float4 PS(Input input) : SV_Target0
{
    float4 color = float4(SkyColor, 1);

    // –@ü‚ª‚Ç‚Ì’ö“x‘¾—z‚ÌŒü‚«‚Éˆê’v‚µ‚Ä‚¢‚é‚©‚ğZo
    // ‘¾—z‚Ì‹t•ûŒü‚Í 0 ‚Æ‚µ‚Ä”jŠü
    float amount = saturate(dot(normalize(input.Normal), SunDirection)) * SunVisible;

    // SunThreshold ‚©‚ç‘¾—z‚Ì”ÍˆÍ‚ğZo
    amount -= SunThreshold;
    amount = saturate(amount);
    amount /= (1 - SunThreshold);

    // ‘¾—z‚ÌF‚ğƒuƒŒƒ“ƒh
    color.rgb += SunColor * amount;

    return color;
}
